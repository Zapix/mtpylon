# -*- coding: utf-8 -*-
import pytest
from aioresponses import aioresponses  # type: ignore

from mtpylon.dh_prime_generators.two_ton import generate, SAFE_PRIME_URL

two_ton_responses = [
    {
        'p': {
            'human': '29,749,001,914,257,905,533,821,621,796,385,130,351,804,895,306,933,420,788,210,276,585,886,958,566,862,068,664,893,110,742,225,612,922,013,234,436,000,245,423,022,562,771,036,853,331,665,435,557,277,665,063,771,848,177,560,502,741,407,281,408,484,151,469,660,500,958,296,085,388,973,483,178,014,179,732,266,242,619,813,925,063,449,598,165,775,942,500,856,204,646,488,420,308,821,849,667,058,157,810,452,033,475,105,946,282,270,811,313,880,835,685,772,931,277,950,553,348,846,490,568,527,518,933,918,916,667,230,934,637,434,337,124,944,282,911,141,632,417,789,855,581,296,558,775,411,230,285,859,641,916,736,062,019,009,644,168,595,562,935,482,246,547,041,775,380,520,570,293,174,319,558,572,826,618,381,946,383,745,972,377,225,066,496,310,875,285,319,890,435,100,838,729,684,421,317,153,499,439,999,621,368,817,127,895,187',  # noqa
            'base10': '29749001914257905533821621796385130351804895306933420788210276585886958566862068664893110742225612922013234436000245423022562771036853331665435557277665063771848177560502741407281408484151469660500958296085388973483178014179732266242619813925063449598165775942500856204646488420308821849667058157810452033475105946282270811313880835685772931277950553348846490568527518933918916667230934637434337124944282911141632417789855581296558775411230285859641916736062019009644168595562935482246547041775380520570293174319558572826618381946383745972377225066496310875285319890435100838729684421317153499439999621368817127895187',  # noqa
            'base16': '0xeba8512c5eec4678332e1ba1f3b68722fe2fe9580fd3a282736e6ac39ea533dbb9a5a7a3cf6ea9cf7d189cc549f2d947a10fd05e6bf0a32b4d95d68b99527d0f38d40d7af4fdaa89d3c4afc281486cd34603902a109360349a4d6dd785be0e373126187dbe41031b656ee1a9efcc7840915a713fece90548cae930d8891433bea7381e226b60b6e301ee13b97bc32106e459f429e1b32e10962d237576e4f3570b52d2227b2baea3e81be407ca825b7b00110abd0f59587562c79ad6c3fb90c89fe53ded3a16786ebffdc14dea031d6f8971d778161d3340760d4588a63afc6271e4e70ad1f87b968f28280abed7e43c2dcc077e1f3f3bf5d80714635a05b093'  # noqa
        },
        'q': {
            'human': '14,874,500,957,128,952,766,910,810,898,192,565,175,902,447,653,466,710,394,105,138,292,943,479,283,431,034,332,446,555,371,112,806,461,006,617,218,000,122,711,511,281,385,518,426,665,832,717,778,638,832,531,885,924,088,780,251,370,703,640,704,242,075,734,830,250,479,148,042,694,486,741,589,007,089,866,133,121,309,906,962,531,724,799,082,887,971,250,428,102,323,244,210,154,410,924,833,529,078,905,226,016,737,552,973,141,135,405,656,940,417,842,886,465,638,975,276,674,423,245,284,263,759,466,959,458,333,615,467,318,717,168,562,472,141,455,570,816,208,894,927,790,648,279,387,705,615,142,929,820,958,368,031,009,504,822,084,297,781,467,741,123,273,520,887,690,260,285,146,587,159,779,286,413,309,190,973,191,872,986,188,612,533,248,155,437,642,659,945,217,550,419,364,842,210,658,576,749,719,999,810,684,408,563,947,593',  # noqa
            'base10': '14874500957128952766910810898192565175902447653466710394105138292943479283431034332446555371112806461006617218000122711511281385518426665832717778638832531885924088780251370703640704242075734830250479148042694486741589007089866133121309906962531724799082887971250428102323244210154410924833529078905226016737552973141135405656940417842886465638975276674423245284263759466959458333615467318717168562472141455570816208894927790648279387705615142929820958368031009504822084297781467741123273520887690260285146587159779286413309190973191872986188612533248155437642659945217550419364842210658576749719999810684408563947593',  # noqa
            'base16': '0x75d428962f76233c19970dd0f9db43917f17f4ac07e9d14139b73561cf5299eddcd2d3d1e7b754e7be8c4e62a4f96ca3d087e82f35f85195a6caeb45cca93e879c6a06bd7a7ed544e9e257e140a43669a301c8150849b01a4d26b6ebc2df071b98930c3edf20818db2b770d4f7e63c2048ad389ff67482a46574986c448a19df539c0f1135b05b7180f709dcbde19083722cfa14f0d997084b1691babb7279ab85a969113d95d751f40df203e5412dbd8008855e87acac3ab163cd6b61fdc8644ff29ef69d0b3c375ffee0a6f5018eb7c4b8ebbc0b0e99a03b06a2c4531d7e3138f2738568fc3dcb479414055f6bf21e16e603bf0f9f9dfaec038a31ad02d849'  # noqa
        },
        'g': {
            'human': 3,
            'base10': 3,
            'base16': '0x3'
        }
    },
    {
        'p': {
            'human': '31,161,765,328,438,092,131,704,438,370,975,398,580,821,692,130,803,368,431,778,929,149,884,882,248,080,338,555,754,456,437,415,514,685,332,636,535,971,759,564,666,992,135,039,210,523,666,002,908,162,177,171,251,196,664,376,275,755,296,274,443,811,412,410,965,741,346,783,054,875,939,808,046,695,924,233,789,224,571,587,114,748,376,481,638,193,324,834,547,206,610,016,759,562,172,788,691,963,510,153,251,526,148,119,308,207,358,866,434,515,043,003,799,698,415,624,427,104,276,896,584,373,774,133,046,237,369,191,999,563,020,638,610,697,530,093,120,097,208,325,279,667,654,115,732,048,868,585,544,285,213,908,808,386,200,627,388,041,599,348,031,948,308,083,996,881,367,198,287,970,302,550,361,092,400,932,274,926,611,302,353,988,847,013,818,884,979,881,157,440,943,643,923,535,392,279,846,293,558,893,212,997,610,073,745,979',  # noqa
            'base10': '31161765328438092131704438370975398580821692130803368431778929149884882248080338555754456437415514685332636535971759564666992135039210523666002908162177171251196664376275755296274443811412410965741346783054875939808046695924233789224571587114748376481638193324834547206610016759562172788691963510153251526148119308207358866434515043003799698415624427104276896584373774133046237369191999563020638610697530093120097208325279667654115732048868585544285213908808386200627388041599348031948308083996881367198287970302550361092400932274926611302353988847013818884979881157440943643923535392279846293558893212997610073745979',  # noqa
            'base16': '0xf6d94667ddff69f32c097d92e23b05aa244a988fc9b11152a12bda50fe1f8ed8c7add62e90f4417ea806f4fd580644c5cbb322403578bfc285b687036496c71237e408c4f7b9fdc7da23ac07557a63fe1afe9e866b19d332578db4bea86b652a906fc649a964d9f3a540ce0d00df26198841f1b29d60c3afbed57d584393d4898e3eeb4493bc27cddf2a9f135dde03f5e2d83ab4abd69ddc4c8e9ab2716fc5bc043b735ede391f8392ce8fca92c889f7ec9428e794c05c7ea86f7f4482b883873086ebf9628144fe184d1478155e59eb52d14c6c03ee5be64822a6587da245be1a2dd0d402f11e71e03d9e2531e3192e29271feb819ee2773b212af88407ea3b'  # noqa
        },
        'q': {
            'human': '15,580,882,664,219,046,065,852,219,185,487,699,290,410,846,065,401,684,215,889,464,574,942,441,124,040,169,277,877,228,218,707,757,342,666,318,267,985,879,782,333,496,067,519,605,261,833,001,454,081,088,585,625,598,332,188,137,877,648,137,221,905,706,205,482,870,673,391,527,437,969,904,023,347,962,116,894,612,285,793,557,374,188,240,819,096,662,417,273,603,305,008,379,781,086,394,345,981,755,076,625,763,074,059,654,103,679,433,217,257,521,501,899,849,207,812,213,552,138,448,292,186,887,066,523,118,684,595,999,781,510,319,305,348,765,046,560,048,604,162,639,833,827,057,866,024,434,292,772,142,606,954,404,193,100,313,694,020,799,674,015,974,154,041,998,440,683,599,143,985,151,275,180,546,200,466,137,463,305,651,176,994,423,506,909,442,489,940,578,720,471,821,961,767,696,139,923,146,779,446,606,498,805,036,872,989',  # noqa
            'base10': '15580882664219046065852219185487699290410846065401684215889464574942441124040169277877228218707757342666318267985879782333496067519605261833001454081088585625598332188137877648137221905706205482870673391527437969904023347962116894612285793557374188240819096662417273603305008379781086394345981755076625763074059654103679433217257521501899849207812213552138448292186887066523118684595999781510319305348765046560048604162639833827057866024434292772142606954404193100313694020799674015974154041998440683599143985151275180546200466137463305651176994423506909442489940578720471821961767696139923146779446606498805036872989',  # noqa
            'base16': '0x7b6ca333eeffb4f99604bec9711d82d512254c47e4d888a95095ed287f0fc76c63d6eb17487a20bf54037a7eac032262e5d991201abc5fe142db4381b24b63891bf204627bdcfee3ed11d603aabd31ff0d7f4f43358ce9992bc6da5f5435b2954837e324d4b26cf9d2a06706806f930cc420f8d94eb061d7df6abeac21c9ea44c71f75a249de13e6ef954f89aeef01faf16c1d5a55eb4eee26474d5938b7e2de021db9af6f1c8fc1c96747e5496444fbf64a1473ca602e3f5437bfa2415c41c3984375fcb140a27f0c268a3c0aaf2cf5a968a63601f72df32411532c3ed122df0d16e86a01788f38f01ecf1298f18c9714938ff5c0cf713b9d90957c4203f51d',  # noqa
        },
        'g': {
            'human': 3,
            'base10': 3,
            'base16': '0x3'
        }
    },
]


@pytest.mark.asyncio
async def test_generate():
    with aioresponses() as m:
        for payload in two_ton_responses:
            m.get(SAFE_PRIME_URL, status=200, payload=payload)

        gen = generate()

        for payload in two_ton_responses:
            expected_value = int(payload['p']['base10'])
            assert await gen.asend(None) == expected_value
